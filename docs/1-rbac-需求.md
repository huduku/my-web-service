


统一权限管理系统：它分为两个层面： 系统层面（控制台） 和 项目层面（前台管理）。
系统层面：
涉及到的实体有 机构，系统用户，
1. 系统用户分属不同的机构。机构是多层级管理的。
2. 系统用户分为 超级管理员， 机构管理员， 系统普通用户， 其登录是统一的。
3. 其中超级管理员的权限有： 管理系统用户、管理功能菜单、管理系统角色、对角色授功能菜单权限， 对用户授予不同的角色， 项目管理，对所有用户可以授予项目操作权限等等。
4. 机构管理员则可管理本机构及其子孙机构下的用户。 可以对所管理的用户授予不同的角色，可以对所管理的用户授予其自身被超管授予的所有项目具有操作权限。
   但是机构管理员不能管理功能菜单、系统角色， 以及对角色授功能菜单权限等。
5. 上边所说的操作权限仅仅是指可以看到相关项目， 至于项目管理员， 则统一由超级管理员统一授予。
6. 普通用户仅仅有被授予的项目的操作权限， 无权看到系统层面的信息。
7. 系统功能菜单是系统的功能模块， 由超级管理员统一管理， 机构管理员和普通用户只能看到自己有权限的功能菜单。
8. 如果机构管理员被授予了某个项目的操作权限， 则其自动会成为该项目的项目管理员。
9. 系统用户的登录信息和权限信息需要加密存储，确保系统的安全性。
10. 系统需要提供日志功能，记录用户的操作行为，以便于审计和追踪。


项目层面：
1. 项目用户分为 项目管理员， 项目普通用户， 系统层面的超级管理员自动是所有项目的项目管理员、机构管理员自动拥有超管所授予其所有项目的项目管理员。
2. 不同的项目有不同项目的功能菜单、项目用户、项目角色。
3. 项目管理员可以管理项目功能菜单、管理项目用户、管理项目角色、对项目角色授功能项目功能菜单权限， 对项目用户授予不同的角色。
4. 项目管理员可以管理项目用户， 其所管理的用户， 也应该遵循机构层级管理的规则。
5. 对于这个统一的权限管理系统而言， 它可以随时接入不同的新的项目。超管以及被授予此项目操作权限的机构管理员可以自由选择其可管理的系统普通用户作为项目的用户。

对于用户：
1. 系统普通用户登录后， 默认进入主界面， 这个界面可以看到自己有权限操作的项目入口。点击项目入口， 则可以进入该项目， 可以看到在该项目下本用户已有的权限的功能， 如果无某功能权限， 用户通过在浏览器地址栏或者使用 curl 等脚本工具请求接口， 则返回 403.
2. 超管， 机构管理员登录后， 默认进入主界面， 这个界面可以看到自己有权限操作的项目入口。点击项目入口， 则可以进入该项目， 可以看到在该项目下本用户已有的权限的功能， 如果无某功能权限， 用户通过在浏览器地址栏或者使用 curl 等脚本工具请求接口， 则返回 403.
   也可以通过右上角切换到系统层面， 看到系统的功能菜单、系统用户、系统角色等信息。

对于 资源
1. 资源管理 功能时， 可以新增、修改、删除菜单， 
2. 菜单下可以新增、修改、删除子菜单， 也可以新增、修改、删除子功能。 但是功能本身不能独立存在， 需要依附在某个菜单

技术角度：
1. 建表语句字段允许为空， 这个不太合规。 应该均设置为不为空的，且有默认值的。对于 text 类型的可以允许默认为空。
2. 表之间的关联关系， 不能通过 sql 约束完成， 要通过业务逻辑来限制。 否则会对造数，维护等造成很大的阻碍。
3. 枚举类型的字段优先使用 small int 类型， 不要使用 enum

业务角度：
1. 需求中明确了， 用户从大的层面应该分为 2 类：  系统用户 和 项目用户。
2. 系统用户角色大体分为三类 超管、机构管理员、普通用户。当然超管可以新建其他系统角色。 机构管理员可以按层级管理本层及子孙层级的普通用户。
3. 项目用户角色可以分为： 项目管理员、其他。 这个其他就是项目管理员新建的其他项目角色。 所以 sql 角色表应该既有系统角色表， 又有项目角色表。

ok, 以此为基础， 生成 rust ddd 架构相关的 data transfer object, command domain entity,  persist object, 框架为 axum， rbatis。
另外系统层面主要功能有：
1. 系统用户注册， 登录， 登出， 修改密码，重置密码
2. 管理系统角色 - crud， 默认角色有 超管，机构管理员，普通用户
3. 管理系统资源 - crud， 功能型资源依附于菜单型资源存在
4. 超管为系统角色授予系统资源权限。 普通用户可以提出其机构管理员拥有的资源权限申请， 超管或者机构管理员审批通过。
5. 管理项目 - crud，
6. 当超管创建项目时， 同时创建对应的系统级别项目角色， 并自动为系统级项目角色分配此项目的操作权限。
7. 如果为某个用户添加系统级项目角色时， 则此人可以操作该项目。 登录系统后， 点击我的项目功能， 可以查看到自己所属角色被分配的项目。
















